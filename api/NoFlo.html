---
layout: default
title: "NoFlo API"
categories:
  - api
---
  <div class="row-fluid">
    <div class="page-title documentation-page-title">
      <div class="container">
        <h1 class="page-title__title">API Documentation</h1>
        <a href="https://github.com/noflo/noflo/blob/master/src/lib/NoFlo.js" class="btn btn-primary page-title__button big-button">On GitHub</a>
      </div>
    </div>
  </div>

  <div class="row-fluid">
    <div class="container documentation-main-container">
      <div class="main">
        <div class="sidebar span4">
        
          <nav>
            <ul class="sidebar__nav">
              
                
                
                <li>
                  <a {% if page.url == '/api/AsCallback/index.html' %}class="active" {% endif %}href="/api/AsCallback/">
                    AsCallback
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/AsComponent/index.html' %}class="active" {% endif %}href="/api/AsComponent/">
                    AsComponent
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/BaseNetwork/index.html' %}class="active" {% endif %}href="/api/BaseNetwork/">
                    BaseNetwork
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/BasePort/index.html' %}class="active" {% endif %}href="/api/BasePort/">
                    BasePort
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/Component/index.html' %}class="active" {% endif %}href="/api/Component/">
                    Component
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/ComponentLoader/index.html' %}class="active" {% endif %}href="/api/ComponentLoader/">
                    ComponentLoader
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/IP/index.html' %}class="active" {% endif %}href="/api/IP/">
                    IP
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/InPort/index.html' %}class="active" {% endif %}href="/api/InPort/">
                    InPort
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/InternalSocket/index.html' %}class="active" {% endif %}href="/api/InternalSocket/">
                    InternalSocket
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/LegacyNetwork/index.html' %}class="active" {% endif %}href="/api/LegacyNetwork/">
                    LegacyNetwork
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/Network/index.html' %}class="active" {% endif %}href="/api/Network/">
                    Network
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/NoFlo/index.html' %}class="active" {% endif %}href="/api/NoFlo/">
                    NoFlo
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/OutPort/index.html' %}class="active" {% endif %}href="/api/OutPort/">
                    OutPort
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/Platform/index.html' %}class="active" {% endif %}href="/api/Platform/">
                    Platform
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/Ports/index.html' %}class="active" {% endif %}href="/api/Ports/">
                    Ports
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/ProcessContext/index.html' %}class="active" {% endif %}href="/api/ProcessContext/">
                    ProcessContext
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/ProcessInput/index.html' %}class="active" {% endif %}href="/api/ProcessInput/">
                    ProcessInput
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/ProcessOutput/index.html' %}class="active" {% endif %}href="/api/ProcessOutput/">
                    ProcessOutput
                  </a>
                </li>
                
              
                
                
                <li>
                  <a {% if page.url == '/api/Utils/index.html' %}class="active" {% endif %}href="/api/Utils/">
                    Utils
                  </a>
                </li>
                
              
            </ul>
          </nav>
        
        </div>
        <div class="content span8">
          <h1>{{ page.title }}</h1>
          
            
            <pre><code>NoFlo - Flow-Based Programming <span class="hljs-keyword">for</span> JavaScript
(c) <span class="hljs-number">2013</span><span class="hljs-number">-2018</span> Flowhub UG
(c) <span class="hljs-number">2011</span><span class="hljs-number">-2012</span> Henri Bergius, Nemein
NoFlo may be freely distributed under the MIT license</code></pre>
<p>NoFlo is a Flow-Based Programming environment for JavaScript. This file provides the
main entry point to the NoFlo network.</p>
<p>Find out more about using NoFlo from <a href="http://noflojs.org/documentation/">http://noflojs.org/documentation/</a></p>

            
              {% raw %}
              <div class='highlight'><pre>
<span class="hljs-comment">/* eslint-disable
    no-param-reassign,
    import/first
*/</span></pre></div>
              {% endraw %}
            
          
            
            <h2 id="main-apis">Main APIs</h2>
<h3 id="graph-interface">Graph interface</h3>
<p><a href="https://github.com/flowbased/fbp-graph">fbp-graph</a> is used for instantiating FBP graph definitions.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">import</span> { graph } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;fbp-graph&#x27;</span>;</pre></div>
              {% endraw %}
            
          
            
            <h2 id="network-instantiation">Network instantiation</h2>
<p>This function handles instantiation of NoFlo networks from a Graph object. It creates
the network, and then starts execution by sending the Initial Information Packets.</p>
<pre><code><span class="hljs-keyword">const</span> network = <span class="hljs-keyword">await</span> noflo.createNetwork(someGraph, {});
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Network is now running!&#x27;</span>);</code></pre>
<p>It is also possible to instantiate a Network but delay its execution by giving the
third <code>delay</code> option. In this case you will have to handle connecting the graph and
sending of IIPs manually.</p>
<pre><code>noflo.createNetwork(someGraph, {
  <span class="hljs-attr">delay</span>: <span class="hljs-literal">true</span>,
})
  .then(<span class="hljs-function">(<span class="hljs-params">network</span>) =&gt;</span> network.connect())
  .then(<span class="hljs-function">(<span class="hljs-params">network</span>) =&gt;</span> network.start())
  .then(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Network is now running!&#x27;</span>);
  });</code></pre>
<h3 id="network-options">Network options</h3>
<p>It is possible to pass some options to control the behavior of network creation:</p>
<ul>
<li><code>baseDir</code>: (default: cwd) Project base directory used for component loading</li>
<li><code>componentLoader</code>: (default: NULL) NoFlo ComponentLoader instance to use for the
network. New one will be instantiated for the baseDir if this is not given.</li>
<li><code>delay</code>: (default: FALSE) Whether the network should be started later. Defaults to
immediate execution</li>
<li><code>flowtrace</code>: (default: NULL) Flowtrace instance to create a retroactive debugging
trace of the network run.</li>
<li><code>subscribeGraph</code>: (default: FALSE) Whether the network should monitor the underlying
graph for changes</li>
</ul>
<p>Options can be passed as a second argument before the callback:</p>
<pre><code>noflo.createNetwork(someGraph, options, callback);</code></pre>
<p>The options object can also be used for setting ComponentLoader options in this
network.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">import</span> { Network } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Network&#x27;</span>;
<span class="hljs-keyword">import</span> { LegacyNetwork } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./LegacyNetwork&#x27;</span>;
<span class="hljs-keyword">import</span> { deprecated } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Platform&#x27;</span>;

<span class="hljs-keyword">export</span> {
  graph,
  Graph,
  journal,
  Journal,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;fbp-graph&#x27;</span>;</pre></div>
              {% endraw %}
            
          
            
            <h3 id="platform-detection">Platform detection</h3>
<p>NoFlo works on both Node.js and the browser. Because some dependencies are different,
we need a way to detect which we’re on.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">export</span> { isBrowser } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Platform&#x27;</span>;</pre></div>
              {% endraw %}
            
          
            
            <h3 id="component-loader">Component Loader</h3>
<p>The <a href="../ComponentLoader/">ComponentLoader</a> is responsible for finding and loading
NoFlo components. Component Loader uses <a href="https://github.com/flowbased/fbp-manifest">fbp-manifest</a>
to find components and graphs by traversing the NPM dependency tree from a given root
directory on the file system.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">export</span> { ComponentLoader } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ComponentLoader&#x27;</span>;</pre></div>
              {% endraw %}
            
          
            
            <h3 id="component-baseclasses">Component baseclasses</h3>
<p>These baseclasses can be used for defining NoFlo components.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">export</span> { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Component&#x27;</span>;</pre></div>
              {% endraw %}
            
          
            
            <h3 id="noflo-ports">NoFlo ports</h3>
<p>These classes are used for instantiating ports on NoFlo components.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">export</span> { InPorts, OutPorts } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Ports&#x27;</span>;

<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> InPort } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./InPort&#x27;</span>;
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> OutPort } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./OutPort&#x27;</span>;</pre></div>
              {% endraw %}
            
          
            
            <h3 id="noflo-sockets">NoFlo sockets</h3>
<p>The NoFlo <a href="InternalSocket.html">internalSocket</a> is used for connecting ports of
different components together in a network.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> internalSocket <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./InternalSocket&#x27;</span>;

<span class="hljs-keyword">export</span> { internalSocket };</pre></div>
              {% endraw %}
            
          
            
            <h3 id="information-packets">Information Packets</h3>
<p>NoFlo Information Packets are defined as “IP” objects.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> IP } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./IP&#x27;</span>;

<span class="hljs-comment">/**
 * @callback NetworkCallback
 * @param {Error | null} err
 * @param {Network|LegacyNetwork} [network]
 */</span>

<span class="hljs-comment">/**
 * @typedef CreateNetworkOptions
 * @property {boolean} [subscribeGraph] - Whether the Network should monitor the graph
 * @property {boolean} [delay] - Whether the Network should be started later
 */</span>

<span class="hljs-comment">/**
 * @typedef { CreateNetworkOptions &amp; import(&quot;./BaseNetwork&quot;).NetworkOptions} NetworkOptions
 */</span>

<span class="hljs-comment">/**
 * @param {import(&quot;fbp-graph&quot;).Graph} graphInstance - Graph definition to build a Network for
 * @param {NetworkOptions} options - Network options
 * @param {NetworkCallback} [callback] - Legacy callback for the created Network
 * @returns {Promise&lt;Network|LegacyNetwork&gt;}
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createNetwork</span>(<span class="hljs-params">graphInstance, options, callback</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options !== <span class="hljs-string">&#x27;object&#x27;</span>) {
    options = {};
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options.subscribeGraph === <span class="hljs-string">&#x27;undefined&#x27;</span>) {
    options.subscribeGraph = <span class="hljs-literal">false</span>;
  }</pre></div>
              {% endraw %}
            
          
            
            <p>Choose legacy or modern network based on whether graph
subscription is needed</p>

            
              {% raw %}
              <div class='highlight'><pre>  <span class="hljs-keyword">const</span> NetworkType = options.subscribeGraph ? LegacyNetwork : Network;
  <span class="hljs-keyword">const</span> network = <span class="hljs-keyword">new</span> NetworkType(graphInstance, options);</pre></div>
              {% endraw %}
            
          
            
            <p>Ensure components are loaded before continuing</p>

            
              {% raw %}
              <div class='highlight'><pre>  <span class="hljs-keyword">const</span> promise = network.loader.listComponents()
    .then(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (options.delay) {</pre></div>
              {% endraw %}
            
          
            
            <p>In case of delayed execution we don’t wire it up</p>

            
              {% raw %}
              <div class='highlight'><pre>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve(network);
      }
      <span class="hljs-keyword">const</span> connected = <span class="hljs-comment">/** @type {Promise&lt;Network|LegacyNetwork&gt;} */</span> (network.connect());
      <span class="hljs-keyword">return</span> connected.then(<span class="hljs-function">() =&gt;</span> network.start());
    });
  <span class="hljs-keyword">if</span> (callback) {
    deprecated(<span class="hljs-string">&#x27;Providing a callback to NoFlo.createNetwork is deprecated, use Promises&#x27;</span>);
    promise.then(<span class="hljs-function">(<span class="hljs-params">nw</span>) =&gt;</span> {
      callback(<span class="hljs-literal">null</span>, nw);
    }, callback);
  }
  <span class="hljs-keyword">return</span> promise;
}</pre></div>
              {% endraw %}
            
          
            
            <h3 id="starting-a-network-from-a-file">Starting a network from a file</h3>
<p>It is also possible to start a NoFlo network by giving it a path to a <code>.json</code> or <code>.fbp</code> network
definition file.</p>
<pre><code>noflo.loadFile(<span class="hljs-string">&#x27;somefile.json&#x27;</span>, {})
  .then(<span class="hljs-function">(<span class="hljs-params">network</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Network is now running!&#x27;</span>);
  });</code></pre>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-comment">/**
 * <span class="hljs-doctag">@param <span class="hljs-type">{string}</span> <span class="hljs-variable">file</span></span>
 * <span class="hljs-doctag">@param <span class="hljs-type">{NetworkOptions}</span> <span class="hljs-variable">options</span></span> - Network options
 * <span class="hljs-doctag">@param <span class="hljs-type">{any}</span> </span>[callback] - Legacy callback
 * <span class="hljs-doctag">@returning <span class="hljs-type">{Promise&lt;Network&gt;}</span></span>
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadFile</span>(<span class="hljs-params">file, options, callback</span>) </span>{
  <span class="hljs-keyword">const</span> promise = graph.loadFile(file)
    .then(<span class="hljs-function">(<span class="hljs-params">graphInstance</span>) =&gt;</span> createNetwork(graphInstance, options));
  <span class="hljs-keyword">if</span> (callback) {
    deprecated(<span class="hljs-string">&#x27;Providing a callback to NoFlo.loadFile is deprecated, use Promises&#x27;</span>);
    promise.then(<span class="hljs-function">(<span class="hljs-params">network</span>) =&gt;</span> {
      callback(<span class="hljs-literal">null</span>, network);
    }, callback);
  }
  <span class="hljs-keyword">return</span> promise;
}</pre></div>
              {% endraw %}
            
          
            
            <h3 id="saving-a-network-definition">Saving a network definition</h3>
<p>NoFlo graph files can be saved back into the filesystem with this method.</p>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-comment">/**
 * <span class="hljs-doctag">@param <span class="hljs-type">{graph.Graph}</span> <span class="hljs-variable">graphInstance</span></span>
 * <span class="hljs-doctag">@param <span class="hljs-type">{string}</span> <span class="hljs-variable">file</span></span>
 * <span class="hljs-doctag">@param <span class="hljs-type">{any}</span> </span>[callback] - Legacy callback
 * <span class="hljs-doctag">@returning <span class="hljs-type">{Promise&lt;string&gt;}</span></span>
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveFile</span>(<span class="hljs-params">graphInstance, file, callback</span>) </span>{
  <span class="hljs-keyword">return</span> graphInstance.save(file, callback);
}</pre></div>
              {% endraw %}
            
          
            
            <h2 id="embedding-noflo-in-existing-javascript-code">Embedding NoFlo in existing JavaScript code</h2>
<p>The <code>asCallback</code> helper provides an interface to wrap NoFlo components
or graphs into existing JavaScript code.</p>
<pre><code><span class="hljs-comment">// Produce an asynchronous function wrapping a NoFlo graph</span>
<span class="hljs-keyword">var</span> wrapped = noflo.asCallback(<span class="hljs-string">&#x27;myproject/MyGraph&#x27;</span>);

<span class="hljs-comment">// Call the function, providing input data and a callback for output data</span>
wrapped({
  <span class="hljs-attr">in</span>: <span class="hljs-string">&#x27;data&#x27;</span>
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, results</span>) </span>{
  <span class="hljs-comment">// Do something with results</span>
});</code></pre>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">export</span> { asCallback, asPromise } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./AsCallback&#x27;</span>;</pre></div>
              {% endraw %}
            
          
            
            <h2 id="generating-components-from-javascript-functions">Generating components from JavaScript functions</h2>
<p>The <code>asComponent</code> helper makes it easy to expose a JavaScript function as a
NoFlo component. All input arguments become input ports, and the function’s
result will be sent to either <code>out</code> or <code>error</code> port.</p>
<pre><code><span class="hljs-built_in">exports</span>.getComponent = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> noflo.asComponent(<span class="hljs-built_in">Math</span>.random, {
    <span class="hljs-attr">description</span>: <span class="hljs-string">&#x27;Generate a random number&#x27;</span>,
  });
};</code></pre>

            
              {% raw %}
              <div class='highlight'><pre><span class="hljs-keyword">export</span> { asComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./AsComponent&#x27;</span>;</pre></div>
              {% endraw %}
            
          
          <p><small>This page contains documentation generated automatically from NoFlo's <a href="https://github.com/noflo/noflo/blob/master/src/lib/NoFlo.js">NoFlo.js</a> file.</small></p>
        </div>
      </div>
    </div>
  </div>
